<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>憑證預授權已產生</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .qr-container {
        background-color: #fff;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin: 0 auto;
        max-width: 300px;
      }
      .offer-link {
        border: 1px solid #dee2e6;
        background-color: #f8f9fa;
        font-family: monospace;
      }
    </style>
  </head>
  <body class="p-4">
    <div class="container">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <div class="d-flex align-items-center">
            <h2 class="mb-0">自然人憑證預授權已產生</h2>
          </div>
        </div>
        <div class="card-body text-center">
          <div class="alert alert-info">
            <p class="mb-0">
              請掃描下方 QR code 或複製連結，使用憑證錢包領取自然人憑證
            </p>
          </div>

          <!-- QR code -->
          <div class="qr-container mb-4">
            <img
              src="{{ qr_path }}"
              alt="QR code"
              class="img-fluid mb-3"
              style="max-width: 220px"
            />
            <p class="text-muted mb-0">憑證編號：{{ vc_id }}</p>
          </div>

          <!-- 顯示 Credential Offer 連結 -->
          <div class="mb-3">
            <div class="input-group">
              <input
                type="text"
                class="form-control offer-link text-center"
                value="{{ offer_url }}"
                id="offerLink"
                readonly
              />
              <button class="btn btn-outline-primary" onclick="copyLink()">
                <i class="bi bi-clipboard"></i> 複製連結
              </button>
            </div>
          </div>

          <div class="alert alert-warning">
            <strong>注意：</strong> 此連結有效期為 24
            小時，請在期限內使用憑證錢包領取
          </div>

          <!-- 說明區 -->
          <div class="card mt-4">
            <div class="card-header bg-light">
              <h5 class="mb-0">如何領取您的憑證</h5>
            </div>
            <div class="card-body text-start">
              <ol>
                <li>打開您的憑證錢包應用</li>
                <li>掃描上方QR碼或從錢包中貼入連結</li>
                <li>依照錢包應用指示完成領取</li>
                <li>領取後可隨時在錢包中查看您的自然人憑證</li>
              </ol>
            </div>
          </div>
        </div>

        <div class="card-footer">
          <div class="d-flex justify-content-center gap-2">
            <a href="/review" class="btn btn-secondary">回審核列表</a>
            <a href="/issued" class="btn btn-secondary">查看已核發</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      function copyLink() {
        const input = document.getElementById("offerLink");
        input.select();
        input.setSelectionRange(0, 99999); // For mobile
        navigator.clipboard.writeText(input.value).then(() => {
          alert("連結已複製到剪貼簿！");
        });
      }
    </script>
  </body>
</html>
